<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>프로필 페이지</title>
    <!-- 다른 헤더 설정 -->
    <th:block th:include="/domain/social/social/header.html"></th:block>
</head>
<body>

<!-- 프로필 섹션 -->
<section class="profile">
    <!-- 유저정보 컨테이너 -->
    <div class="profileContainer">

        <!-- 유저이미지 -->
        <div class="profile-left">
            <div class="profile-img-wrap story-border" th:if="${profileDto.getEmail() eq #authentication.principal.username}">
                <!-- 이미지 및 파일 업로드 폼 -->
                <form id="userProfileImageForm" enctype="multipart/form-data" action="/social/profile/${profileDto.id}" method="post" th:if="${profileDto.getEmail() eq #authentication.principal.username}">
                    <!-- 파일 선택을 위한 input 추가 -->
                    <input type="file" name="multipartFiles" id="userProfileImageInput" style="display: none;" onchange="handleFileSelect(this)"/>
                    <!-- 파일 선택 창을 열기 위한 라벨 사용 -->
                    <label for="userProfileImageInput" style="cursor: pointer; display: none;">사진 선택</label>
                    <!-- 파일 전송 버튼을 숨기고, 대신 파일 선택 창을 여는 함수 호출 -->
                    <button class="cta" onclick="document.getElementById('userProfileImageInput').click()">사진 등록</button>
                </form>

                <!-- 프로필 이미지 -->
                <img class="profile-image" th:src="${profileDto.getProfileImage() != null ? profileDto.getProfileImage() : 'https://kr.object.ncloudstorage.com/hypeimagebucket/SOCIAL/person.jpeg'}"/>
            </div>
        </div>
        <!-- 유저이미지 end -->

        <!-- 유저정보 및 사진등록 구독하기 -->
        <div class="profile-right">
            <div class="name-group">
                <h2 th:text="${profileDto.getNickname()}"></h2>

                <!-- 사용자가 로그인한 사용자인 경우 -->
                <div th:if="${profileDto.getEmail() eq #authentication.principal.username}">
                    <!-- 기존의 사진선택 버튼을 삭제 -->
                    <!-- <label for="userProfileImageInput" style="cursor: pointer; display: none;">사진 선택</label> -->
                    <!-- 파일 전송 버튼은 그대로 유지하면서 버튼 클릭 시 파일 선택 창이 열리도록 수정 -->
                    <button class="cta" onclick="document.getElementById('userProfileImageInput').click()">사진 등록</button>
                    <button class="modi" onclick="popup('.modal-info')">
                        <i class="fas fa-cog"></i>
                    </button>
                </div>

                <!-- 다른 사용자인 경우 -->
                <div th:unless="${profileDto.getEmail() eq #authentication.principal.username}">
                    <button class="cta" th:onclick="'toggleSubscribe(' + ${profileDto.id} + ', this)'"></button>
                </div>
            </div>

            <div class="subscribe">
                <ul>
                    <li><a href=""> 게시물<span></span></a></li>
                </ul>
            </div>
            <div class="state">
            </div>
        </div>
        <!-- 유저정보 및 사진등록 구독하기 end -->

    </div>
</section>


<!-- 로그아웃, 회원정보변경 모달 -->
<!-- 해당 부분 제거 -->
<!-- 로그아웃, 회원정보변경 모달 end -->



<!--프로필사진 바꾸기 모달end-->





<script th:src="@{/js/socialmemberprofile.js}"></script>

<!-- 다른 푸터 설정 -->
<th:block th:include="/domain/social/social/footer.html"></th:block>

</body>
</html>


